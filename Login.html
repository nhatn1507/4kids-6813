<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Log In - VegEatable</title>

    <!-- COMMON LIBRARIES -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> <!-- need this for arrow Glyphicon to display correctly -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script
    src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
    integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
    crossorigin="anonymous"></script>


    <!-- Use mobile-aware viewport -->
    <meta name="viewport" content= "width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- ICONS LIBRARY -->
    <script src="https://use.fontawesome.com/9f03d0cffe.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.css" integrity="sha256-D3+gw6JE4hEJ9pnCs+BglSfZ2yG5gF+JGdPJ/v183fo=" crossorigin="anonymous" />

    <!-- MAIN CSS -->
    <link href="https://fonts.googleapis.com/css?family=EB+Garamond" rel="stylesheet">
    <link rel="stylesheet" href="login.css">
    <link href="https://fonts.googleapis.com/css?family=Nobile" rel="stylesheet">
</head>
<div id="result"></div>

<script>
//localStorage.setItem("email_password_dict", JSON.stringify({}));
localStorage.setItem("email_meta_info_dict", JSON.stringify({}));
var email_password_dict = {}
var email_meta_info_dict = {}
if (typeof(Storage) !== "undefined") {
    // Store

    // Retrieve
    email_password_dict = JSON.parse(localStorage.getItem("email_password_dict"));
    if (email_password_dict == null){email_password_dict = {}};
    email_meta_info_dict = JSON.parse(localStorage.getItem("email_password_dict"));
    if (email_meta_info_dict == null){email_password_dict = {}};


} else {
    window.alert("Critical failure!");
}


function login(){
  username = document.getElementById("email").value;
  password = document.getElementById("pass").value;
  if (username in email_password_dict){
    if (email_password_dict[username] == password){
      window.location = "home.html"
    }
    else{
      window.alert("Password/Username is wrong!");
    }
  }
  else{
    window.alert("Password/Username is wrong!");
  }

}

function signup(){
  username = document.getElementById("email2").value;
  password = document.getElementById("pass2").value;
  first_name = document.getElementById("first").value;
  last_name = document.getElementById("last").value;
  zip_code = document.getElementById("zip").value;

  if (username.length > 0 && password.length > 0 && first_name.length > 0 && last_name.length > 0 && zip_code.length > 0){
    if (username in email_password_dict){
      window.alert("Email already has account");
    }
    else{
      email_password_dict[username] = password
      email_meta_info_dict[username] = {"first_name":first_name, "last_name":last_name, "zip_code":zip_code}
      localStorage.setItem("email_password_dict", JSON.stringify(email_password_dict));
      localStorage.setItem("email_meta_info_dict", JSON.stringify(email_meta_info_dict));
      window.alert("Signup Successful");
      document.getElementById("email2").value = "";
      document.getElementById("pass2").value = "";
      document.getElementById("first").value = "";
      document.getElementById("last").value = "";
      document.getElementById("zip").value = "";
    }
  }
  else{
    window.alert("Fill out all fields!")
  }
}

function password_forgot(){
  var username = prompt("Pretend that we sent you an email and that you use that to reset the password. But this is pretty hard. Instead, write your email.")
  if (username != null && username != ""){
    if (username in email_password_dict){
      window.alert("Your password is: " + email_password_dict[username].toString());
    }
    else{
      window.alert("Couldn't find email.")
    }
  }
}



</script>

<body>
    <div id="container">
        <div id="header"> VegEatable </div>


        <div id="left" style="height: 90vh; padding: 10% 0;">
            <div id="innerleft">
                <div style="margin: 0 auto; max-width: 300px; ">
                    <div style="font-size: 20px; padding: 0 5px; text-shadow: 0 0 2px #66ffa5; color:white;"> Log In </div>
                    <div style="position:relative; left:15%; bottom: 0; font-size: 12px; padding-bottom: 5px; color:white; text-shadow: 0 0 2px #66ffa5;"> <i> Existing customer</i></div>
                </div>


                <div style="margin: 0 auto; max-width: 300px; padding:20px 0;"> <input type="email" class="form-control" placeholder="Email" id="email"> </div>

                <div style="margin: 0 auto; max-width: 300px;"> <input type="password" class="form-control" placeholder="Password" id="pass"> </div>

                <div style="margin: 0 auto; max-width: 300px;">  <a href="#" style="float:right; margin: 5px 0; color:white;" onclick = "password_forgot()"> <strong> <u>Forgot password? </u> </strong> </a>  </div>

                <br>
                <div style="width: 60%; max-width: 200px; margin: 20px auto;"> <button type="submit" class="btn btn-block" style="background-color: #66ffa5; clear: both;" onclick="login()"><b>Log In </b> </button> </div>
            </div>
        </div>


        <div id="right" style="height: 90vh; padding: 10% 0;">
            <div id="innerright">
                <div style="margin: 0 auto; max-width: 300px; ">
                    <div style="font-size: 20px; padding: 0 5px; text-shadow: 0 0 3px #8559da; color:white;"> Sign Up </div>
                    <div style="position:relative; left:15%; font-size: 12px; padding-bottom: 5px; color:white; text-shadow: 0 0 3px  #8559da;"> <i> New to</i> <b> VegEatable</b></div>
                </div>

                <div class='userinput' style="overflow:auto;">
                    <div  style="float: left; width: 50%; padding-right: 5px;"> <input type="text" class="form-control" id="first" placeholder="Given Name"> </div>
                    <div style="float: left; width: 50%; padding-left: 5px;"> <input type="text" class="form-control" id="last" placeholder="Family Name"> </div>
                </div>



                <div class='userinput'> <input type="email" class="form-control" placeholder="Email" id="email2"> </div>

                <div class='userinput'> <input type="password" class="form-control" placeholder="Password" id="pass2"> </div>


                <div class="userinput"> <input type="text" class="form-control" placeholder="Zip Code" id="zip"> </div>


                <div style="width: 60%; max-width: 200px; margin: 20px auto;"> <button type="submit" class="btn btn-block" style="color: white; background-color: #8559da; clear: both; " onclick="signup()"><b>Sign Up </b> </button> </div>

                <div id="messages" style = "color:white;float: left; width: 50%; padding-right: 5px;"> </div>
            </div>
        </div>




    </div>

</body>
